---
title: "assignment3"
author: "Jake Eisaguirre"
date: "2/12/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(here)
library(janitor)
library(tidyverse)
library(kableExtra)
library(estimatr)
```


### Clean Data

\noindent The following code loads and cleans the data.
```{r}
data <- read.csv("SMOKING_EDS241.csv") %>% 
  clean_names()
```

### (a) What is the unadjusted mean difference in birth weight of infants with smoking and nonsmoking mothers? Under what hypothesis does this correspond to the average treatment effect of maternal smoking during pregnancy on infant birth weight? Provide some simple empirical evidence for or against this hypothesis.

\noindent The following code calculates the undjusted mean difference 
```{r}
avg_birth_smoke <- data %>% 
  filter(tobacco >= 1) %>% 
  summarize(mean_birth_smoker = mean(birthwgt))



avg_birth_nonsmoke <- data %>% 
  filter(tobacco <= 0) %>% 
  summarize(mean_birth_nonsmoker = mean(birthwgt))

unadjusted_mean <- avg_birth_smoke - avg_birth_nonsmoke

kable(unadjusted_mean)

empirical_evidence <- lm(birthwgt ~ alcohol, data = data)

tidy(empirical_evidence) %>% 
  kable()

```

\noindent The assumption is, if smoking was randomly assigned among mothers, then we wouldn't expect to see a difference between other covariates. Based on the un-adjusted mean differences of birthwgt ~ alcohol we can see there is other variables with non mean differences.

### (b) Assume that maternal smoking is randomly assigned conditional on the observable covariates listed above. Estimate the effect of maternal smoking on birth weight using a linear regression. Report the estimated coefficient on tobacco and its standard error.

\noindent The following code estimates the effect of maternal smoking on birth weight conditional on the observable
covariates listed above
```{r}
mod1 <- lm_robust(birthwgt ~ tobacco + anemia + diabete + alcohol + meduc + first + mage + mblack, data)

tidy(mod1) %>% 
  kable()


```

\noindent The estimated coefficient on tobacco is a decrease of 228.07 grams in baby birth weight for parents who smoke and the standard error is -236.45g and -219.69g 

### (c) Report the estimated average treatment effect of smoking on birthweight using the exact matching estimator and its linear regression analogue. 

\noindent The following codes estimates the effect of maternal smoking on birth weight
```{r}

match_est <- data %>% 
  mutate(mage = ifelse(mage >= 34, c(0), c(1)),
         meduc = ifelse(meduc >= 16, c(0), c(1))) %>% 
  select(meduc, mage, alcohol, mblack, tobacco, birthwgt) %>% 
  mutate(g = paste0(meduc, mage, alcohol, mblack))

mod2 <- lm_robust(birthwgt ~ tobacco + factor(g), data = match_est)

tidy(mod2) %>% 
  kable()
```

### (d) Estimate the propensity score for maternal smoking using a logit estimator and based on the following specification: mother’s age, mother’s age squared, mother’s education, and indicators for mother’s race, and alcohol consumption. 

\noindent The following code estimates the propensity score 
```{r}

```

### (e) Use the propensity score weighted regression (WLS) to estimate the effect of maternal smoking on birth weight

\noindent The following code estimates 
```{r}

```

